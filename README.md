
# Time Series Anomaly Detection

This project aims to detect anomalies in time series data using three different models: MomentFM, Informer, and PatchTST. The process involves data preprocessing, model training, fine-tuning, and evaluation using various datasets.

## Contents

- `anomaly_detection.ipynb`: Jupyter notebook for anomaly detection using the MomentFM model.
- `anomaly_detection_dataset.py`: Script for loading and processing datasets.
- Informer Model Files: 
  - `informer_ECL.ipynb`
  - `informer_ETTh1.ipynb`
  - `informer_WTH.ipynb`
- PatchTST Model Files: 
  - `patchTST_ECL.ipynb`
  - `patchTST_ETTh1.ipynb`
  - `patchTST_WTH.ipynb`
- Results Directory: Contains output visualizations and comparison graphs.

## Prerequisites

- **MomentFM**: Framework for time series anomaly detection.
- **Informer**: Efficient transformer model for long sequence time-series forecasting.
- **PatchTST**: Model for time-series forecasting and anomaly detection.
- **Python 3.11**: Ensure you have the correct Python version installed.
- **Jupyter Notebook**: Interactive computing environment.
- **Required Python libraries**: Install using the provided requirements file.

## Installation

### Install Dependencies

```sh
pip install -r requirements.txt
pip install momentfm
```

## Datasets

Place your datasets in the `datasets/` directory. Ensure the filenames match the following:

- `133_UCR_Anomaly_InternalBleeding14_2800_5607_5634.txt`
- `155_UCR_Anomaly_PowerDemand4_18000_24005_24077.txt`
- `113_UCR_Anomaly_CIMIS44AirTemperature1_4000_5391_5392.txt`

## Running the Models

### MomentFM

#### Open the Jupyter Notebook

```sh
jupyter notebook anomaly_detection.ipynb
```

#### Load and Preprocess the Data

Within the notebook, set the dataset path and load the data:

```python
dataset_path = 'datasets/133_UCR_Anomaly_InternalBleeding14_2800_5607_5634.txt'
# Load and preprocess the data here
```

Detailed preprocessing steps should be included in the notebook, such as handling missing values, normalizing data, and splitting into train/test sets.

#### Train and Evaluate the Model

- Execute the training cell to train the MomentFM model.
- Run the testing cell to evaluate the model performance.
- Evaluate using metrics like MSE (Mean Squared Error) and MAE (Mean Absolute Error).
- Visualize the results with plots comparing predicted and actual values.

### Running Informer and PatchTST

#### Open the Jupyter Notebooks

For each model file, start the notebook:

```sh
jupyter notebook informer_ECL.ipynb
jupyter notebook informer_ETTh1.ipynb
jupyter notebook informer_WTH.ipynb

jupyter notebook patchTST_ECL.ipynb
jupyter notebook patchTST_ETTh1.ipynb
jupyter notebook patchTST_WTH.ipynb
```

#### Execute the Notebooks

- Follow the instructions within each notebook to load data, preprocess it, and train the models.
- The notebooks guide through each step, including data loading, preprocessing (normalization, handling missing data), model training, and evaluation.

#### Evaluate Results

- Assess the model performance using metrics provided in the notebooks, such as MSE, MAE, or other relevant metrics.
- Compare performance across different datasets and models to identify the best-performing model.

### Repeat Steps for Other Datasets

Follow the same steps for each dataset listed in the Contents section for both the MomentFM and the other models (Informer and PatchTST). Ensure that each dataset is correctly loaded and preprocessed according to the specific requirements of each model.

## Results

The `results` directory contains various output images and visualizations generated by the models, including:
- `airtemp_comparison.png`
- `airtemp_output.png`
- `airtemp_testdata.png`
- `informerMT000_results.png`
- `informerMT320_results.png`
- `internalbleedin_output.png`
- `internalbleedin_testdata.png`
- `internalbleeding_comparison.png`
- `powerdem_testdata.png`
- `powerdemand_comparison.png`
- `powerdemand_output.png`

These visualizations include comparison graphs, model output visualizations, and test data visualizations.

## Conclusion

- This project demonstrates how to detect anomalies in time series data using different models.
- Detailed instructions for each step are provided within the respective Jupyter notebooks.
- Comparing the performance of different models across various datasets helps in understanding their effectiveness and applicability.


